<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>è½¦è¾†é’¢æ¿æ£€æµ‹</title>
    <!-- å¼•å…¥ç›¸å…³çš„JavaScriptæ–‡ä»¶ -->
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/echarts.min.js"></script>
    <script type="text/javascript" src="js/china.js"></script>
    <script type="text/javascript" src="js/map.js"></script>
    <script type="text/javascript" src="js/js.js"></script>
    <script type="text/javascript" src="js/area_echarts.js"></script>
    <!-- å¼•å…¥CSSæ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="css/style.css">
    <style>
      /* å®šä¹‰ä¸€ä¸ªå®¹å™¨ç±»ï¼Œç”¨äºæ°´å¹³å’Œå‚ç›´å±…ä¸­å†…å®¹ */
      .pulll {
            position: static;
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        /* æ–°å¢æ ·å¼ï¼Œç”¨äºæ¨¡å—æ ‡é¢˜å¸ƒå±€ */
       .module-titles {
            position: absolute;
            bottom: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            width: 100%;
            z-index: 1;
            /* ç¡®ä¿æ ‡é¢˜æ˜¾ç¤ºåœ¨å…¶ä»–å…ƒç´ ä¹‹ä¸Š */
        }

       .module-titles .tit {
            width: 100%;
            margin-bottom: 5px;
            /* å¯æ ¹æ®éœ€è¦è°ƒæ•´æ ‡é¢˜ä¹‹é—´çš„é—´è· */
        }

    
        /* è°ƒæ•´å­åŒºåŸŸçš„æ ·å¼ */
       .sub-region {
            width: 50%;
            height: 100%;
            box-sizing: border-box;
            padding: 10px;
            /* ç»™å›¾è¡¨é¢„ç•™ä¸€äº›å†…è¾¹è· */
        }

        /* ç”¨äºæ”¾ç½® ECharts å›¾è¡¨çš„å®¹å™¨ */
       .echart-container {
            width: 100%;
            height: 100%;
        }
        /* æ˜¾ç¤ºéšè—æ§åˆ¶ */
       .mainbox.hidden {
            display: none;
        }

        /* æå‡å¯¼èˆªèœå•å±‚çº§ */
       .head {
            z-index: 999;
            position: relative;
        }

        /* æŠ¥å‘Šæ¨¡æ€æ¡†æ ·å¼ */
       .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

       .modal-content {
            background-color: #1f2836;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #3a4659;
            width: 80%;
            max-width: 1200px;
            min-height: 600px;
            position: relative;
        }

       .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            z-index: 1001;
            /* ç¡®ä¿å…³é—­æŒ‰é’®å±‚çº§é«˜äºæ¨¡æ€æ¡† */
            position: relative;
            pointer-events: auto;
            /* ç¡®ä¿æŒ‰é’®å¯ç‚¹å‡» */
        }

       .close:hover,
       .close:focus {
            color: white;
            text-decoration: none;
            cursor: pointer;
        }

       .report-title {
            text-align: center;
            margin-bottom: 30px;
            color: #daf9ff;
        }

       .report-section {
            margin-bottom: 40px;
        }

       .report-section h3 {
            color: #07e5ff;
            border-bottom: 2px solid #3a4659;
            padding-bottom: 8px;
            margin-bottom: 15px;
        }

       .report-data {
            line-height: 1.8;
            color: #c3d4eb;
            white-space: pre-line;
        }

    
      

/* ä¿®æ”¹ä¸­é—´åˆ—å®¹å™¨æ ·å¼ */
li[style*="width: 78%"] {
    height: 100vh; /* æ’‘æ»¡è§†å£é«˜åº¦ */
    display: flex;
    flex-direction: column;
}

/* è°ƒæ•´åœ°å›¾å®¹å™¨æ ·å¼ */
.boxnav.mapc {
    width: 100% !important;
    height: 100% !important; /* æ’‘æ»¡çˆ¶å®¹å™¨ */
    position: relative;
    padding: 0; /* ç§»é™¤å†…è¾¹è· */
    background: transparent !important;
    border: none !important;
}
.boxnav.mapc {
  width: 100% !important; /* è¦†ç›–åŸ700pxå›ºå®šå®½åº¦ */
  height: 100%;
}
/* ä¿®æ”¹å›¾ç‰‡ç½‘æ ¼æ ·å¼ */
/* ä¿®æ”¹å›¾ç‰‡ç½‘æ ¼æ ·å¼ */
.image-grid {
    display: grid;
    grid-auto-rows: minmax(180px, auto);
   
    width: 100%;
    overflow-x: auto; 
    flex-wrap: wrap;
    background: transparent;
        gap: 15px;
        padding: 15px;
        grid-template-columns: repeat(4, 1fr); 

        
}

/* å›¾ç‰‡å®¹å™¨æ ·å¼ */
.image-grid a {
    aspect-ratio: 1; /* ä¿æŒ1:1æ¯”ä¾‹ */
    min-width: 200px; /* æœ€å°å®½åº¦é™åˆ¶ */
    position: relative;
    flex-grow: 1;
    border-radius: 8px;
    overflow: hidden;
    transition: all 0.3s ease;
    background: transparent;
    border: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    width: calc(100% - 10px); /* æ”¹ç”¨ç™¾åˆ†æ¯”+è¾¹è· */
    margin: 5px;
    
}
/* å›¾ç‰‡æ‚¬åœæ•ˆæœ */
.image-grid a:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
}

.image-grid a:hover img {
    transform: scale(1.05);
}
/* å›¾ç‰‡æ ·å¼ */
.image-grid img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
    border-radius: 8px;
}

@media (max-width: 1200px) {
    .image-grid {
        grid-template-columns: repeat(4, 1fr); /* ä¿æŒ4åˆ— */
    }
}

@media (max-width: 992px) {
    .image-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}

@media (max-width: 768px) {
    .image-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
    }
}

@media (max-width: 576px) {
    .image-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}
        /* å›¾ç‰‡åŠ è½½å¤±è´¥æ ·å¼ */
       .image-grid img.error {
            background-color: #f5f5f5;
            border: 1px solid #ccc;
            padding: 20px;
            text-align: center;
        }

        /* åŠ è½½åŠ¨ç”»æ ·å¼ */
       .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }

       .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }


       .hidden {
            display: none;
        }
        /* å®šä¹‰.screen-switchç±»çš„æ ·å¼ï¼Œè¯¥ç±»é€šå¸¸ç”¨äºåŒ…è£¹åŒ…å«æŒ‰é’®ç»„å’Œæ ‡é¢˜çš„æ•´ä¸ªå¯¼èˆªåŒºåŸŸ */
.screen-switch {
    /* ä½¿ç”¨ç›¸å¯¹å®šä½ï¼Œä¸ºå­å…ƒç´ çš„ç»å¯¹å®šä½æä¾›å‚è€ƒ */
    position: relative;
    /* è®¾ç½®å…ƒç´ å®½åº¦ä¸ºå…¶çˆ¶å…ƒç´ å®½åº¦çš„ 100% */
    width: 100%;
    /* ä½¿ç”¨ Flexbox å¸ƒå±€ï¼Œä½¿å­å…ƒç´ å¯ä»¥æ°´å¹³æ’åˆ—å¹¶çµæ´»æ§åˆ¶å¯¹é½æ–¹å¼ */
    display: flex;
    /* è®©å­å…ƒç´ åœ¨æ°´å¹³æ–¹å‘ä¸Šä¸¤ç«¯å¯¹é½ï¼Œä¸­é—´ç•™å‡ºç©ºç™½ */
    justify-content: space-between;
    /* ä½¿å­å…ƒç´ åœ¨å‚ç›´æ–¹å‘ä¸Šå±…ä¸­å¯¹é½ */
    align-items: center;
    /* è®¾ç½®å…ƒç´ çš„å†…è¾¹è·ï¼Œä¸Šå’Œä¸‹ä¸º 10pxï¼Œå·¦å’Œå³ä¸º 20px */
    padding: 10px 20px;
}

/* å®šä¹‰.button-groupç±»çš„æ ·å¼ï¼Œè¯¥ç±»ç”¨äºåŒ…è£¹ä¸€ç»„æŒ‰é’®ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†æŒ‰é’®å¸ƒå±€ */
.button-group {
    /* ä½¿ç”¨ Flexbox å¸ƒå±€ï¼Œä½¿æŒ‰é’®å¯ä»¥æ°´å¹³æ’åˆ— */
    display: flex;
    /* è®¾ç½®æŒ‰é’®ä¹‹é—´çš„é—´è·ä¸º 12px */
    gap: 12px;
    /* ä½¿æŒ‰é’®åœ¨å‚ç›´æ–¹å‘ä¸Šå±…ä¸­å¯¹é½ */
    align-items: center;
}

/* å®šä¹‰.switch-btnç±»çš„æ ·å¼ï¼Œè¯¥ç±»ç”¨äºè®¾ç½®åˆ‡æ¢æŒ‰é’®çš„é€šç”¨æ ·å¼ */
.switch-btn {
    /* å°†æŒ‰é’®ä»¥è¡Œå†…å¼¹æ€§ç›’å­çš„å½¢å¼æ˜¾ç¤ºï¼Œå…è®¸å®ƒä¸å…¶ä»–å…ƒç´ åœ¨åŒä¸€è¡Œæ˜¾ç¤ºä¸”å…·æœ‰å¼¹æ€§å¸ƒå±€ç‰¹æ€§ */
    display: inline-flex;
    /* ä½¿æŒ‰é’®å†…çš„å†…å®¹åœ¨å‚ç›´æ–¹å‘ä¸Šå±…ä¸­å¯¹é½ */
    align-items: center;
    /* è®¾ç½®æŒ‰é’®çš„å†…è¾¹è·ï¼Œä¸Šå’Œä¸‹ä¸º 8pxï¼Œå·¦å’Œå³ä¸º 20px */
    padding: 0px 8px;
    /* è®¾ç½®æŒ‰é’®çš„è¾¹æ¡†åœ†è§’ä¸º 20pxï¼Œä½¿æŒ‰é’®è¾¹è§’æ›´åœ†æ¶¦ */
    border-radius: 20px;

    /* è®¾ç½®æŒ‰é’®å†…æ–‡å­—çš„é¢œè‰² */
    color: #c3d4eb;
    /* å»é™¤æŒ‰é’®ä½œä¸ºè¶…é“¾æ¥æ—¶çš„ä¸‹åˆ’çº¿ */
    text-decoration: none;
    /* ä¸ºæŒ‰é’®çš„æ‰€æœ‰å±æ€§å˜åŒ–æ·»åŠ è¿‡æ¸¡æ•ˆæœï¼Œè¿‡æ¸¡æ—¶é—´ä¸º 0.3 ç§’ï¼Œè¿‡æ¸¡æ–¹å¼ä¸ºç¼“åŠ¨ */
    transition: all 0.3s ease;
    /* è®¾ç½®æŒ‰é’®çš„è¾¹æ¡†ï¼Œå®½åº¦ä¸º 1pxï¼Œå®çº¿ï¼Œé¢œè‰²ä¸º #475467 */
    border: 1px solid #475467;
    /* è®¾ç½®æŒ‰é’®å†…æ–‡å­—çš„å­—ä½“å¤§å°ä¸º 14px */
    font-size: 14px;
    background: transparent;
    border: 0;
  
    box-shadow: none;
}

/* å­ç…§ç‰‡å®¹å™¨æ ·å¼ */
.sub-photos-container {
    display: none;
    background-color: #333;
    padding: 10px;
    z-index: 100;
    transition: all 0.3s ease;
    grid-column: 1 / -1; /* ä»ç„¶å æ®æ•´è¡Œï¼Œä½†ç”±äºåˆ—æ•°è‡ªåŠ¨è°ƒæ•´ï¼Œä¸ä¼šæ’‘æ»¡å±å¹• */
    display: flex;
    flex-wrap: wrap;
    justify-content: start;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    padding: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    margin-top: 10px;
    
}

.sub-photos-container img {
    width: auto; 
    border-radius: 6px;
    margin: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    height: 150px;
    margin: 5px;
}

/* å›¾ç‰‡ç¼©æ”¾æ ·å¼ï¼Œç‚¹å‡»ç…§ç‰‡æ—¶å…¶ä»–ç…§ç‰‡ç¼©å° */
.image-grid.clicked a:not(.active) {
    transform: scale(0.8);
    opacity: 0.5;
}

.image-grid a.active {
    transform: scale(1);
    opacity: 1;
}
    </style>
</head>

<body>
    <div class="screen-switch">
        <div class="button-group">
            <a href="index1.html" class="switch-btn">ğŸ” æ£€æµ‹è§†å›¾</a>
            <a href="index2.html" class="switch-btn">ğŸ“Š æ•°æ®å¤§å±</a>
            <button id="generateReportBtn" class="switch-btn">ğŸ“„ ç”ŸæˆæŠ¥å‘Š</button>
        </div>
        <h1 class="center-title">è½¦è¾†é’¢æ¿æ£€æµ‹</h1>
    </div>
    
          <!-- ä¸»ä½“å†…å®¹åŒºåŸŸ -->
    <div class="mainbox">
        <div class="screen-container">
            <!-- <iframe class="screen-iframe" id="screenFrame"></iframe> -->
        </div>

        <ul class="clearfix nav1">
            <!-- å·¦ä¾§åˆ— -->
            <li style="width: 22%">
                <div class="box">
                    <div class="tit"></div>
                    <div class="boxnav" style="height: 350px;" id="echart2">
                        <div class="yqlist">
                        </div>
                    </div>
                </div>
                <!-- æ–°å¢å½“å‰å‚æ•°åŒºåŸŸ -->
                <div class="box">
                    <div class="tit">å½“å‰å‚æ•°</div>
                    <div class="boxnav" style="height: 200px;">

                    </div>
                </div>
                <!-- <div class="box">
                    <div class="tit"></div>
                    <div class="boxnav" style="height: 150px;">

                    </div>
                   
                 
                </div> -->
            </li>
            <!-- ä¸­é—´åˆ— -->
            <li style="width: 78%; height: 100vh;">
                <div class="box" style="height: 100%;">
                    <div class="boxnav mapc">
                        <div class="image-grid" id="imageGrid">
                            <!-- ä¿æŒåŸæœ‰å›¾ç‰‡ç»“æ„ -->
                            <div class="loading">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
    </div>

    <!-- æŠ¥å‘Šç”Ÿæˆæ¨¡æ€æ¡† -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="download-buttons">
                <button id="downloadPDF">ä¸‹è½½ PDF</button>
                <button id="downloadJPG">ä¸‹è½½ JPG</button>
                <button id="downloadWord">ä¸‹è½½ Word</button>
            </div>
            <span class="close">&times;</span>
            <h2 class="report-title">è½¦è¾†é’¢æ¿ç¼ºé™·æ£€æµ‹æŠ¥å‘Š</h2>

            <div class="report-section">
                <h3>åŸºæœ¬ä¿¡æ¯</h3>
                <div class="report-data" id="basicInfo"></div>
            </div>

            <div class="report-section">
                <h3>æ£€æµ‹ç»“æœ</h3>
                <div class="report-data" id="detectionResult"></div>
            </div>

            <div class="report-section">
                <h3>äº§ç”ŸåŸå› </h3>
                <div class="report-data" id="causeAnalysis"></div>
            </div>

            <div class="report-section">
                <h3>å»ºè®®æ¨¡å—</h3>
                <div class="report-data" id="suggestions"></div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹ŸçœŸå®å›¾ç‰‡æ•°æ®ï¼ˆæ›¿æ¢ä¸ºä½ è‡ªå·±çš„å›¾ç‰‡URLï¼‰

const imageData = [
    {
        thumbnail: "https://picsum.photos/200/200?random=1",
        fullsize: "https://picsum.photos/800/600?random=1",
        subPhotos: [
            "https://picsum.photos/800/600?random=11",
            "https://picsum.photos/800/600?random=12"
        ]
    },
    {
        thumbnail: "https://picsum.photos/200/200?random=2",
        fullsize: "https://picsum.photos/800/600?random=2",
        subPhotos: [
            "https://picsum.photos/800/600?random=21",
            "https://picsum.photos/800/600?random=22"
        ]
    },
    {
        thumbnail: "https://picsum.photos/200/200?random=3",
        fullsize: "https://picsum.photos/800/600?random=3",
        subPhotos: [
            "https://picsum.photos/800/600?random=31",
            "https://picsum.photos/800/600?random=32"
        ]
    },
    {
        thumbnail: "https://picsum.photos/200/200?random=4",
        fullsize: "https://picsum.photos/800/600?random=4",
        subPhotos: [
            "https://picsum.photos/800/600?random=41",
            "https://picsum.photos/800/600?random=42"
        ]
    }
];

        // å›¾ç‰‡åŠ è½½å‡½æ•°
        function loadImages() {
    const wall = document.getElementById('imageGrid');
    const loader = document.querySelector('.loading');

            // æ¨¡æ‹Ÿ1ç§’åŠ è½½æ—¶é—´
            setTimeout(() => {
                // æ¸…ç©ºåŠ è½½åŠ¨ç”»
                loader.style.display = 'none';

                // åˆ›å»ºå›¾ç‰‡å¡ç‰‡
                imageData.forEach((img, index) => {
                    const card = document.createElement('a');
                    card.href = img.fullsize;
                 

                    const image = document.createElement('img');
                    image.className = 'thumbnail';
                    image.src = img.thumbnail;
                    image.alt = `è¡¨é¢ç¼ºé™· ${index + 1}`;

                    // é”™è¯¯å¤„ç†
                    image.onerror = function () {
                        this.src = 'https://via.placeholder.com/200x200?text=Image+Not+Available';
                    };

                    card.appendChild(image);
                    wall.appendChild(card);
                });// åˆå§‹åŒ–æ‡’åŠ è½½
        const lazyImages = document.querySelectorAll('img[data-src]');
        const lazyLoad = (target) => {
            const io = new IntersectionObserver((entries, observer) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.getAttribute('data-src');
                        img.classList.add('loaded');
                        observer.disconnect();
                    }
                });
            });
            io.observe(target);
        };

        lazyImages.forEach(lazyLoad);
    }, 100);
}

       
            

// æ·»åŠ çª—å£å¤§å°ç›‘å¬
window.addEventListener('resize', () => {
  clearTimeout(this.resizeTimer);
  this.resizeTimer = setTimeout(loadImages, 200);
});
        // é¡µé¢åˆ‡æ¢æ§åˆ¶
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.screen-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetType = this.dataset.target;
                    const targetSrc = this.dataset.src;

                    if (targetType === 'current') {
                        document.querySelector('.screen-container').style.display = 'none';
                        document.querySelector('.mainbox').classList.remove('hidden');
                    } else {
                        document.querySelector('.mainbox').classList.add('hidden');
                        const iframe = document.getElementById('screenFrame');
                        iframe.src = targetSrc;
                        document.querySelector('.screen-container').style.display = 'block';
                    }
                });
            });
            document.querySelector('.screen-container').style.display = 'none';

            // æ–°å¢å¤§å±åˆ‡æ¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const screenSwitchBtn = document.getElementById('screenSwitchBtn');
            const mainbox = document.querySelector('.mainbox');
            const screenContainer = document.querySelector('.screen-container');
            const screenFrame = document.getElementById('screenFrame');

            screenSwitchBtn.addEventListener('click', function () {
                if (mainbox.classList.contains('hidden')) {
                    mainbox.classList.remove('hidden');
                    screenContainer.style.display = 'none';
                    screenSwitchBtn.textContent = 'åˆ‡æ¢åˆ°å¤§å±';
                } else {
                    mainbox.classList.add('hidden');
                    screenContainer.style.display = 'block';
                    screenFrame.src = 'index2.html';
                    screenSwitchBtn.textContent = 'åˆ‡æ¢å›å½“å‰å±';
                }
            });
        });

        // è·å–åŠ¨æ€æ•°æ®çš„å‡½æ•°ï¼ˆç¤ºä¾‹ï¼‰
        function getDynamicData() {
            return {
                basicInfo: `
                    æ£€æµ‹æ—¶é—´ï¼š${new Date().toLocaleString()}
                    æ–‡ä»¶è·¯å¾„ï¼šæ— 
                    æ£€æµ‹æ¨¡å¼ï¼šæ— 
                `,
                detectionResult: `
                    åˆæ ¼ç‡ï¼šæ— 
                    ç¼ºé™·åˆ†ç±»ï¼šæ— 
                `,
                causeAnalysis: "æ ¹æ®æ£€æµ‹ç»“æœåˆ†æï¼Œä¸»è¦åŸå› ä¸ºï¼š\n1. åŸææ–™è¡¨é¢å¤„ç†ä¸è¾¾æ ‡\n2. è½§åˆ¶è¿‡ç¨‹æ¸©åº¦æ§åˆ¶å¼‚å¸¸",
                suggestions: "å»ºè®®é‡‡å–ä»¥ä¸‹æªæ–½ï¼š\n1. åŠ å¼ºåŸææ–™è´¨æ£€æµç¨‹\n2. ä¼˜åŒ–è½§åˆ¶å·¥è‰ºå‚æ•°\n3. å¢åŠ åœ¨çº¿ç›‘æµ‹è®¾å¤‡"
            };
        }

        // åˆå§‹åŒ–æŠ¥å‘Šç”ŸæˆæŒ‰é’®
        document.getElementById('generateReportBtn').addEventListener('click', function () {
            const modal = document.getElementById('reportModal');
            const data = getDynamicData();

            document.getElementById('basicInfo').textContent = data.basicInfo;
            document.getElementById('detectionResult').textContent = data.detectionResult;
            document.getElementById('causeAnalysis').textContent = data.causeAnalysis;
            document.getElementById('suggestions').textContent = data.suggestions;

            modal.style.display = 'block';
        });

        // å…³é—­æ¨¡æ€æ¡†
        document.getElementById('reportModal').addEventListener('click', function (e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        document.querySelector('.close').addEventListener('click', function () {
            document.getElementById('reportModal').style.display = 'none';
        });

        // ä¸‹è½½ PDF åŠŸèƒ½
        document.getElementById('downloadPDF').addEventListener('click', async () => {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const reportContent = document.querySelector('.modal-content');
            const text = reportContent.innerText;
            doc.text(text, 10, 10);
            doc.save('report.pdf');
        });

        // ä¸‹è½½ JPG åŠŸèƒ½
        document.getElementById('downloadJPG').addEventListener('click', async () => {
            const reportContent = document.querySelector('.modal-content');
            const canvas = await html2canvas(reportContent);
            const dataURL = canvas.toDataURL('image/jpeg');
            const link = document.createElement('a');
            link.href = dataURL;
            link.download = 'report.jpg';
            link.click();
        });

        // ä¸‹è½½ Word åŠŸèƒ½
        document.getElementById('downloadWord').addEventListener('click', async () => {
            const reportContent = document.querySelector('.modal-content').innerHTML;
            const zip = new window.PizZip();
            const doc = new window.docxtemplater(zip);
            const content = `
            <w:document xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
                <w:body>
                    ${reportContent}
                </w:body>
            </w:document>
            `;
            zip.file('word/document.xml', content);
            try {
                doc.render();
            } catch (error) {
                console.error('Word æ–‡æ¡£ç”Ÿæˆå¤±è´¥:', error);
                return;
            }
            const out = doc.getZip().generate({ type: 'blob' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(out);
            link.download = 'report.docx';
            link.click();
        });// åˆ‡æ¢æ—¶ä¿æŒç­›é€‰çŠ¶æ€
document.querySelectorAll('.screen-switch a').forEach(link => {
    link.addEventListener('click', () => {
        const currentFilter = {
            dateRange: getCurrentDateRange(),
            defectType: getSelectedDefectType()
        };
        localStorage.setItem('filterSettings', JSON.stringify(currentFilter));
    });
});
// æ£€æµ‹æµè§ˆå™¨æ”¯æŒç‰¹æ€§
if ('serviceWorker' in navigator) {
    // æ³¨å†ŒPWAæ”¯æŒ
    navigator.serviceWorker.register('/sw.js');
}
// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
window.onload = function () {
    loadImages();

    const imageGrid = document.getElementById('imageGrid');
    imageGrid.addEventListener('click', function (e) {
    console.log('Image grid clicked');
    if (e.target.tagName === 'IMG') {
        e.preventDefault(); // é˜»æ­¢ a æ ‡ç­¾çš„é»˜è®¤è¡Œä¸º
        const parentLink = e.target.parentNode;
        const index = Array.from(imageGrid.children).indexOf(parentLink);
        const subPhotos = imageData[index].subPhotos;

        console.log('Image clicked, showing sub photos');
        // éšè—æ‰€æœ‰å·²æ˜¾ç¤ºçš„å­ç…§ç‰‡å®¹å™¨
        const allSubContainers = document.querySelectorAll('.sub-photos-container');
        allSubContainers.forEach(container => {
            container.style.display = 'none';
        });

        // ç§»é™¤æ‰€æœ‰å›¾ç‰‡çš„ active ç±»
        const allImages = document.querySelectorAll('.image-grid a');
        allImages.forEach(img => {
            img.classList.remove('active');
        });

        // ç»™å½“å‰ç‚¹å‡»çš„å›¾ç‰‡æ·»åŠ  active ç±»
        parentLink.classList.add('active');

        // ä¸ºå›¾ç‰‡ç½‘æ ¼æ·»åŠ  clicked ç±»ï¼Œè§¦å‘å…¶ä»–å›¾ç‰‡ç¼©å°æ•ˆæœ
        imageGrid.classList.add('clicked');

        // åˆ›å»ºæˆ–æ˜¾ç¤ºå½“å‰ç…§ç‰‡çš„å­ç…§ç‰‡å®¹å™¨
        let subContainer = parentLink.nextElementSibling;
        if (!subContainer || !subContainer.classList.contains('sub-photos-container')) {
            subContainer = document.createElement('div');
            subContainer.classList.add('sub-photos-container');
            subPhotos.forEach(subPhoto => {
                const img = document.createElement('img');
                img.src = subPhoto;
                subContainer.appendChild(img);
            });
            imageGrid.insertBefore(subContainer, parentLink.nextSibling);
        }
        subContainer.style.display = 'block';
    }
});}
   // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹éšè—å­ç…§ç‰‡å®¹å™¨å¹¶æ¢å¤å›¾ç‰‡å¤§å°
document.addEventListener('click', function (e) {
    const imageGrid = document.getElementById('imageGrid');
    if (!imageGrid.contains(e.target) &&!document.querySelectorAll('.sub-photos-container').some(container => container.contains(e.target))) {
        const allSubContainers = document.querySelectorAll('.sub-photos-container');
        allSubContainers.forEach(container => {
            container.style.display = 'none';
        });
        const allImages = document.querySelectorAll('.image-grid a');
        allImages.forEach(img => {
            img.classList.remove('active');
        });
        imageGrid.classList.remove('clicked');
    }
});
    </script>
</body>

</html>